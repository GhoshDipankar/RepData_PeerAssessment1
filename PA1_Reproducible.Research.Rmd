---
title: 'Reproducible Research: Peer Assessment 1'
author: "Dipankar Ghosh"
date: "23 May 2020"
output: 
  html_document: 
    keep_md: yes
---
### Prerequisite:  
#### Packages used:
```{r packages, message=FALSE}
library(dplyr)
library(ggplot2)
```
#### Global option setting:
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data

```{r download}
# URL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
# Downloading and unzipping file:
# download.file(URL, destfile = "data.zip")
unzip("activity.zip")
# Reading of Data into a data frames called
activitydata <- read.csv("activity.csv")
```


## Question-1: What is mean total number of steps taken per day?

For this part of the assignment, the missing values in the dataset are ignored.

#### 1. Calculate the total number of steps taken per day
For proper estimation of mean of the total number of steps taken per day,  
na.rm is made FALSE in order to ignore those days when no data is collected.

```{r}
totalsteps <- with(activitydata, tapply(steps, date, sum, na.rm = FALSE))
```

#### 2. Make a histogram of the total number of steps taken each day
```{r Histogram}
hist(totalsteps, breaks = 10, col = "lightblue", xlab = "Total Steps", 
     main = "Total number of steps taken each day")  
```
  
#### 3. Calculate and report the mean and median of the total number of steps taken per day  
Mean of the total number of steps taken per day:
```{r Mean}
mean_withNA <- mean(totalsteps, na.rm = TRUE)
print(mean_withNA)
```
Median of the total number of steps taken per day:
```{r Median}
median_withNA <- median(totalsteps, na.rm = TRUE)
print(median_withNA)
```

## Question-2: What is the average daily activity pattern?

#### 1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
Preparation od a data frame consisting of intervals and Average number of steps taken, averaged across all days: 
```{r}
stepsperinterval <- aggregate(steps~interval, data=activitydata, mean)
```
Plot of Daily Avg. Steps with Intervals:
```{r LinePlot1}
with(stepsperinterval, 
     plot(interval, steps, type = "l", col="blue", lwd = 2, xlab="Interval", ylab="Daily Avg. Steps",
     main = "Average number of steps taken, averaged across all days"))
```
  
#### 2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r max.interval}
maxinterval <- stepsperinterval[which.max(stepsperinterval$steps),1]
```
##### The 5-minute interval "`r maxinterval`", contains the maximum number of steps on average across all the days in the dataset.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?